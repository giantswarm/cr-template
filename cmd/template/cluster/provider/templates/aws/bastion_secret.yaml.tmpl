apiVersion: v1
kind: Secret
metadata:
  labels:
    cluster.x-k8s.io/cluster-name: {{ .Name }}
    cluster.x-k8s.io/role: bastion
    cluster.x-k8s.io/watch-filter: capi
    giantswarm.io/cluster: {{ .Name }}
    giantswarm.io/organization: {{ .Owner }}
    release.giantswarm.io/version: {{ .ReleaseVersion }}
  name: {{ .Name }}-bastion
  namespace: {{ .Namespace }}
stringData:
  value: |-
    {
       "ignition":{
          "version":"2.2.0"
       },
       "passwd":{
          "users":[
             {
                "name":"giantswarm",
                "sshAuthorizedKeys":[
                   "ssh-rsa AAAABEKf fake@giantswarm"
                ],
                "groups":[
                   "sudo",
                   "docker"
                ],
                "shell":"/bin/bash",
                "uid":1000
             }
          ]
       },
       "storage":{
          "files":[
             {
                "path":"/etc/hostname",
                "filesystem":"root",
                "mode": 420,
                "contents":{
                   "source":"data:,{{ .Name }}-bastion"
                }
             },
             {
                "path":"/etc/ssh/sshd_config",
                "filesystem":"root",
                "mode": 420,
                "contents":{
                   "source":"data:text/plain;charset=utf-8;base64,IyBVc2UgbW9zdCBkZWZhdWx0cyBmb3Igc3NoZCBjb25maWd1cmF0aW9uLgpTdWJzeXN0ZW0gc2Z0cCBpbnRlcm5hbC1zZnRwCkNsaWVudEFsaXZlSW50ZXJ2YWwgMTgwClVzZUROUyBubwpVc2VQQU0geWVzClByaW50TGFzdExvZyBubyAjIGhhbmRsZWQgYnkgUEFNClByaW50TW90ZCBubyAjIGhhbmRsZWQgYnkgUEFNCiMgTm9uIGRlZmF1bHRzICgjMTAwKQpDbGllbnRBbGl2ZUNvdW50TWF4IDIKUGFzc3dvcmRBdXRoZW50aWNhdGlvbiBubwpUcnVzdGVkVXNlckNBS2V5cyAvZXRjL3NzaC90cnVzdGVkLXVzZXItY2Eta2V5cy5wZW0KTWF4QXV0aFRyaWVzIDUKTG9naW5HcmFjZVRpbWUgNjAKQWxsb3dUY3BGb3J3YXJkaW5nIHllcwpBbGxvd0FnZW50Rm9yd2FyZGluZyB5ZXMKQ0FTaWduYXR1cmVBbGdvcml0aG1zIGVjZHNhLXNoYTItbmlzdHAyNTYsZWNkc2Etc2hhMi1uaXN0cDM4NCxlY2RzYS1zaGEyLW5pc3RwNTIxLHNzaC1lZDI1NTE5LHJzYS1zaGEyLTUxMixyc2Etc2hhMi0yNTYsc3NoLXJzYQ=="
                }
             },
             {
                "path":"/etc/ssh/trusted-user-ca-keys.pem",
                "filesystem":"root",
                "mode": 420,
                "contents":{
                   "source":"data:text/plain;charset=utf-8;base64,c3NoLXJzYSBBQUFBQjNOemFDMXljMkVBQUFBREFRQUJBQUFDQVFDOGhDMUlsQllJdy9pbE1hakVUSTdJdSt0aUgxTlJKbmtBRjhNSmdYajA2TzVUK0hCa2pIWkJOdC96N25UNWhhcXp1TGk5eHpnaUN2dHpxOWFOQ3pqZExZOTlzVW42YnllR1RPdkpWUjh1SUlCRXZ3d0NNODJaMWVTemF2QkpsS1ZQd0wvV3lyYkpnV3BUbmk0SFZiWWhmSXdtWUN1aU83Y3J6UjFBZHlwMVkvMEVxR2c3RnNQTzBzMmNsQStYZkQxbEdManhvL0ZZSGgvUkR6cVB1WENDSU5RTTI1UzhlQTJoR0taSnBHbmUwd0JWYUJMaFBkOC9MSDFkZnVEdHUwSHRpZHg2RlRTdnQ4dEdmQVh4R0FjeUtaYkgzNjcyVzN1TzZDVkxxTUVCVGlXamgvUVRLUWdGWlIvMWdiODZtOG8rUVZCQ29OVmdXNVBzRDNUb09QK0xiWDV6aGVkRU1UbXZVdWQ4a0NTaHdabWwvWTF1eE12Wms2YmhWZUg0VFBmdUJ3ZXdCUU9DVkYrOU5GeEQ0Q2hISjdsSlVkVUwvMFgybHphb2xzbUowUkh2bVZ1bStod01XTjhsRm5xNTl2Q1lqdnIxUmxuVE9OWWNibXhyZXFqd0RLajVjY2NVYkVURWJ1dGYvYVFUVk1zSjZZbkJScGFVdmlmUUtsWHJCTXc4dWtpUU9tTDUwOHpnRitSMWd2RlI0ZDRoUWg4VmhsdEUraHdyeUlHQlNMdVZtMmhaN08zT0h2bFNQS3p2MGVmMUlyT1lhaVFaWUpWUGlPb0VFMU0yS3hVOXhaMFlnKzZudWtQL2cvVklXUzlZQ2RzY1o4NWFTUGl5T05xNkRKaG51WjhVOEJWV1N0K05ka2RnSVRaUmx2QVcvdjJZWlZBbW1zWXR0UktMRFE9PQ=="
                }
             }
          ]
       }
    }
type: cluster.x-k8s.io/secret
